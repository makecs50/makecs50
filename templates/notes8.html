---
layout: header
title: Note8
permalink: /weeks/notes8/
---

<div class="toc2 toc-left">
            <div id="header">
                <div class="toc2" id="toc">
                    <div id="toctitle">Список Контента</div>
                    <ul class="sectlevel1">
<li><a href="#intro-to-python">Введение в Python</a></li>
<li><a href="#first-programs">Первые программы</a></li>
<li><a href="#logical-programs">Логические программы</a></li>
<li><a href="#more-complex-programs">Более сложные программы</a></li>
<li><a href="#web-servers">Веб-сервер</a></li>
</ul>
                </div>
            </div>
            <div id="content">
                <h1>Неделя 8</h1>
<div class="sect1">
<h2 id="intro-to-python"><a class="link" href="#intro-to-python">Введение в Python</a></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Си не всегда является лучшим выбором для решения проблем вычислительного мира, так как нам самим приходится имплементировать многочисленные структуры данных, не говоря о самостоятельной регулеровке памяти.</p>
</li>
<li>
<p>Более высокоуровневые языки программирования оснащены дополнительными фишками и абстракциями, помогающие программистам в их нелегком деле.</p>
</li>
<li>
<p>Точно так же, как и процесс перехода со Scratch на Си продемонстрировал нам схожесть концепций компьютерных языков, процесс перехода с Си на Python будет следовать этому же сценарию.</p>
</li>
<li>
<p>Первая программа написанная на Си, "hello, world" (Привет, мир!), может быть очень легко представлена на языке Python:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;hello, world&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
</li>
<li>
<p>Мы можем добавить функцию <code>main</code>, хотя данный шаг не так обязателен в Python, как это было в Си:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-k">def</span> <span class="tok-nf">main</span><span class="tok-p">():</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;hello, world&quot;</span><span class="tok-p">)</span>

<span class="tok-k">if</span> <span class="tok-vm">__name__</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;__main__&quot;</span><span class="tok-p">:</span>
    <span class="tok-n">main</span><span class="tok-p">()</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Обратите внимание, что в Python мы определяем функцию линией <code>def main():</code>, оставляя позади привычку добавления фигурных скобок, но взамен приучая себя к отступам, отвечающие за иерархию кода.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Функцию <code>printf</code> еще легче можно записывать в Python, просто <code>print</code>. Нам не нужно в конце прибавлять управляющий символ <code>\n</code>, так как язык добавляет его за нас.</p>
</li>
<li>
<p>Бесконечный цикл в Python выглядит так:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-k">while</span> <span class="tok-bp">True</span><span class="tok-p">:</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;hello, world&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Булеан <code>True</code> должен начинаться с заглавной буквы.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Цикл с определенным количеством повторов:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-mi">50</span><span class="tok-p">):</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;hello, world&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Переменная <code>i</code>, на каждой итерации, будет последовательно хранить в себе текущий элемент перебираемого массива и все это будет проделываться без вашей имплементации. Функция <code>range(50)</code> автоматически создает список (массив) чисел заданного диапазона (от <code>0</code> до <code>49</code> по умолчанию, если мы дадим ей в качестве параметра число <code>50</code>).</p>
</li>
</ul>
</div>
</li>
<li>
<p>В Python также существуют типы переменных, но, в отличии от Си, он не является строго типизированным языком. Наоборот, это слабо типизированный язык. Другими словами, нам не нужно каждый раз уточнять тип нашей переменной.</p>
</li>
<li>
<p>Мы просто пишем:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-n">i</span> <span class="tok-o">=</span> <span class="tok-mi">0</span></code></pre>
</div>
</div>
</li>
<li>
<p>Булеан выражения схожи с теми, что мы разбирали в Си: <code>i &lt; 50</code>, <code>x &lt; y</code>.</p>
</li>
<li>
<p>Условия тоже не отличаются:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-k">if</span> <span class="tok-n">x</span> <span class="tok-o">&lt;</span> <span class="tok-n">y</span><span class="tok-p">:</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;x меньше y&quot;</span><span class="tok-p">)</span>
<span class="tok-k">elif</span> <span class="tok-n">x</span> <span class="tok-o">&gt;</span> <span class="tok-n">y</span><span class="tok-p">:</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;x больше y&quot;</span><span class="tok-p">)</span>
<span class="tok-k">else</span><span class="tok-p">:</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;x равен y&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Обратите внимание, что мы больше не ставим скобки вокруг наших выражений и вместо того, чтобы использовать фигурные скобки, мы перешли к отступам, показывая ими принадлежность кода к определенному блоку (конструкциям if, while, def и т.п.).</p>
</li>
<li>
<p>И <code>elif</code> является ключевым словом Python, означающим <code>else if</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Массивами в Python называют списками. Вам больше не придется контролировать память и следить за ее утечками, язык сам это делает за вас.</p>
</li>
<li>
<p>Синтаксис списков совпадает с синтаксисом массивов Си. Если в Си мы использовали <code>argv[0]</code>, чтобы получить аргумент командной строки, то в Python мы будем пользоваться <code>sys.argv[0]</code>.</p>
</li>
<li>
<p>Также отметим, что Си компилируется из исходного кода в машинный код, а язык Python является интерпретируемым. Это значит, что мы можем запустить нашу программу всего одной командой, которая займется всем необходимым, чтобы достигнуть поставленной нами цели (запуска программы).</p>
</li>
<li>
<p>К примеру, мы запустим написанную нами программу командой <code>python hello.py</code>. Она запустит программу под названием <code>python</code>, которой далее будет передан аргумент <code>hello.py</code>, содержащий исходный код нашей программы.</p>
</li>
<li>
<p><code>python</code> также является интерпретатором, т.е. программой способной компилировать исходный код в так называемый байткод (представлен ниже), далее считывая и запуская его:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>2       0   LOAD_GLOBAL         0   (print)
        3   LOAD_CONST          1   ('hello,    world')
        6   CALL_FUNCTION       1   (1  positional, 0   keyword pair)
        9   POP_TOP
        10  LOAD_CONST          0   (None)
        13  RETURN_VALUE</code></pre>
</div>
</div>
</li>
<li>
<p>Поэтому Python - это одновременно язык и программа, компилирующая и интерпретирующая свой же язык (в то время как Си является языком, а <code>clang</code> - отдельным компилятором).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="first-programs"><a class="link" href="#first-programs">Первые программы</a></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Мы снова упростим вам изучение нового языка, добавив функции библиотеки (модуля) CS50:</p>
<div class="ulist">
<ul>
<li>
<p><code>cs50.get_char</code></p>
</li>
<li>
<p><code>cs50.get_float</code></p>
</li>
<li>
<p><code>cs50.get_int</code></p>
</li>
<li>
<p><code>cs50.get_string</code></p>
</li>
<li>
<p>&#8230;&#8203;</p>
</li>
</ul>
</div>
</li>
<li>
<p>Эти функции являются частью модуля <code>cs50</code>, поэтому, вызывая функцию, нам нужно указать к какому модулю она принадлежит.</p>
</li>
<li>
<p>В Python мы повстречаем знакомые нам типы данных:</p>
<div class="ulist">
<ul>
<li>
<p><code>bool</code></p>
</li>
<li>
<p><code>float</code></p>
</li>
<li>
<p><code>int</code></p>
</li>
<li>
<p><code>str</code> (string или строка, в которую встроены специальные функции, позволяющие легко манипулировать ею)</p>
</li>
<li>
<p><code>complex</code> (сложные или воображаемые числа)</p>
</li>
<li>
<p><code>list</code> (как массивы)</p>
</li>
<li>
<p><code>tuple</code> (группы значений, например координаты x и y)</p>
</li>
<li>
<p><code>range</code></p>
</li>
<li>
<p><code>set</code> (коллекция объектов с определенными свойствами)</p>
</li>
<li>
<p><code>dict</code> (словарь, схож с хеш-таблицей)</p>
</li>
<li>
<p><code>&#8230;&#8203;</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Давайте сохраним файл <code>hello.py</code>, поместив туда следующее:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;hello, world&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
</li>
<li>
<p>Далее мы можем запустить <code>python hello.py</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>$ python hello.py
hello, world</code></pre>
</div>
</div>
</li>
<li>
<p>Превратим это:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="c"><span class="tok-cp">#include</span> <span class="tok-cpf">&lt;cs50.h&gt;</span><span class="tok-cp"></span>
<span class="tok-cp">#include</span> <span class="tok-cpf">&lt;stdio.h&gt;</span><span class="tok-cp"></span>

<span class="tok-kt">int</span> <span class="tok-nf">main</span><span class="tok-p">(</span><span class="tok-kt">void</span><span class="tok-p">)</span>
<span class="tok-p">{</span>
    <span class="tok-n">string</span> <span class="tok-n">name</span> <span class="tok-o">=</span> <span class="tok-n">get_string</span><span class="tok-p">();</span>
    <span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;hello, %s</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">,</span> <span class="tok-n">name</span><span class="tok-p">);</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
</li>
<li>
<p>в это:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-kn">import</span> <span class="tok-nn">cs50</span>

<span class="tok-n">s</span> <span class="tok-o">=</span> <span class="tok-n">cs50</span><span class="tok-o">.</span><span class="tok-n">get_string</span><span class="tok-p">()</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;hello, {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">s</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>import</code> - синтакс добавления библиотеки.</p>
</li>
<li>
<p>Потом мы объяляем переменную <code>s</code>, без уточнения ее типа, и вызываем метод <code>cs50.get_string()</code>, далее сохраняя возвращаемый результат в <code>s</code>.</p>
</li>
<li>
<p>Затем включаем <code>s</code> в отображаемые нами на экране данные. Строки (strings) или еще точнее объекты, имеют встроенные функции. Мы вызываем эти функции с помощью синтаксиса <code>"hello, {}".format(s)</code>, и, предоставляя правильные аргументы, мы можем подставлять переменные так, как сами этого пожелаем.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Существует две основные версии Python, версия 2 и 3, у которых присутствует достаточное количество различий, делающие невозможным программам написанным на одной версии языка быть работоспособными на другой.</p>
</li>
<li>
<p>Мы будем пользоваться Python 3, хотя в интернете и присутствует огромное количество документаций или онлайн уроков, в которых все еще задействован Python 2.</p>
</li>
<li>
<p>У Python также есть функция <code>input</code>, которая позволяет выполнять тот же функционал, что и библиотека CS50:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-n">s</span> <span class="tok-o">=</span> <span class="tok-nb">input</span><span class="tok-p">(</span><span class="tok-s2">&quot;name: &quot;</span><span class="tok-p">)</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;hello, {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">s</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>В качестве параметра этой функции, мы можем указать текстовый запрос, понятный нашему пользователю. Далее, после ввода пользователем определенный данных, функция вернет нам эти данные (поместит в переменную <b>s</b>).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Точно также мы можем получить число:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-kn">import</span> <span class="tok-nn">cs50</span>

<span class="tok-n">i</span> <span class="tok-o">=</span> <span class="tok-n">cs50</span><span class="tok-o">.</span><span class="tok-n">get_int</span><span class="tok-p">()</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;hello, {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">))</span></code></pre>
</div>
</div>
</li>
<li>
<p>Можно вывести на экран числа с плавающими запятыми, уточнив разрядность таким образом, что мы сможем увидеть неточность Python, такую же как и в Си:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;{:.55f}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-mi">1</span> <span class="tok-o">/</span> <span class="tok-mi">10</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Значение, которое мы планируем вывести, выглядит так <code>1 / 10</code> и форматирование уточняется с помощью <code>:55f</code> (внутри фигурных скобках строки).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Запустим и увидим:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>`0.1000000000000000055511151231257827021181583404541015625`</code></pre>
</div>
</div>
</li>
<li>
<p>В Си, если мы поделим один <code>int</code> на другой <code>int</code>, то получим еще один <code>int</code>. Но Python, в отличии от Си, способен автоматически определять и возвращать значения с плавающей точкой (float).</p>
</li>
<li>
<p>Мы можем написать знакомую нам программу, в которой используются различные операторы:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-kn">import</span> <span class="tok-nn">cs50</span>

<span class="tok-c1"># запросить у пользователя X</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;x это &quot;</span><span class="tok-p">,</span> <span class="tok-n">end</span><span class="tok-o">=</span><span class="tok-s2">&quot;&quot;</span><span class="tok-p">)</span>
<span class="tok-n">x</span> <span class="tok-o">=</span> <span class="tok-n">cs50</span><span class="tok-o">.</span><span class="tok-n">get_int</span><span class="tok-p">()</span>

<span class="tok-c1"># запросить у пользователя Y</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;y это &quot;</span><span class="tok-p">,</span> <span class="tok-n">end</span><span class="tok-o">=</span><span class="tok-s2">&quot;&quot;</span><span class="tok-p">)</span>
<span class="tok-n">y</span> <span class="tok-o">=</span> <span class="tok-n">cs50</span><span class="tok-o">.</span><span class="tok-n">get_int</span><span class="tok-p">()</span>

<span class="tok-c1"># вычисления</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;{} плюс {} будет {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">x</span><span class="tok-p">,</span> <span class="tok-n">y</span><span class="tok-p">,</span> <span class="tok-n">x</span> <span class="tok-o">+</span> <span class="tok-n">y</span><span class="tok-p">))</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;{} минус {} будет {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">x</span><span class="tok-p">,</span> <span class="tok-n">y</span><span class="tok-p">,</span> <span class="tok-n">x</span> <span class="tok-o">-</span> <span class="tok-n">y</span><span class="tok-p">))</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;{} умножить на {} даст {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">x</span><span class="tok-p">,</span> <span class="tok-n">y</span><span class="tok-p">,</span> <span class="tok-n">x</span> <span class="tok-o">*</span> <span class="tok-n">y</span><span class="tok-p">))</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;{} поделить на {} даст {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">x</span><span class="tok-p">,</span> <span class="tok-n">y</span><span class="tok-p">,</span> <span class="tok-n">x</span> <span class="tok-o">/</span> <span class="tok-n">y</span><span class="tok-p">))</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;{} поделить на {} (и опустить) даст {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">x</span><span class="tok-p">,</span> <span class="tok-n">y</span><span class="tok-p">,</span> <span class="tok-n">x</span> <span class="tok-o">//</span> <span class="tok-n">y</span><span class="tok-p">))</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;остаток от деления {} на {} будет равен {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">x</span><span class="tok-p">,</span> <span class="tok-n">y</span><span class="tok-p">,</span> <span class="tok-n">x</span> <span class="tok-o">%</span> <span class="tok-n">y</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>В Python присутствует специальный оператор <code>//</code>, который делит два integera и возвращает усеченный integer (удалив всё, что идет после запятой).</p>
</li>
<li>
<p>И комментарии в Python, вместо того чтобы начинаться с <code>//</code>, будут начинаться с <code>#</code>.</p>
</li>
<li>
<p>Мы передаем <code>end=""</code> в качестве дополнительного параметра функции <code>print</code>, чтобы избежать автоматического добавления новой строки в конце текста.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Напишем программу для конвертации температур:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-kn">import</span> <span class="tok-nn">cs50</span>

<span class="tok-n">f</span> <span class="tok-o">=</span> <span class="tok-n">cs50</span><span class="tok-o">.</span><span class="tok-n">get_float</span><span class="tok-p">()</span>
<span class="tok-n">c</span> <span class="tok-o">=</span> <span class="tok-mf">5.0</span> <span class="tok-o">/</span> <span class="tok-mf">9.0</span> <span class="tok-o">*</span> <span class="tok-p">(</span><span class="tok-n">f</span> <span class="tok-o">-</span> <span class="tok-mf">32.0</span><span class="tok-p">)</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;{:.1f}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">c</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Получаем float <code>f</code>, применяем подходящую формулу и сохраняем результат в <code>c</code>, а также уточняем вывод одного дробного разряда <code>:1f</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="logical-programs"><a class="link" href="#logical-programs">Логические программы</a></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Работа с логикой:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-kn">import</span> <span class="tok-nn">cs50</span>

<span class="tok-n">c</span> <span class="tok-o">=</span> <span class="tok-n">cs50</span><span class="tok-o">.</span><span class="tok-n">get_char</span><span class="tok-p">()</span>
<span class="tok-k">if</span> <span class="tok-n">c</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;Y&quot;</span> <span class="tok-ow">or</span> <span class="tok-n">c</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;y&quot;</span><span class="tok-p">:</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;yes&quot;</span><span class="tok-p">)</span>
<span class="tok-k">elif</span> <span class="tok-n">c</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;N&quot;</span> <span class="tok-ow">or</span> <span class="tok-n">c</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;n&quot;</span><span class="tok-p">:</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;no&quot;</span><span class="tok-p">)</span>
<span class="tok-k">else</span><span class="tok-p">:</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;ошибка&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Мы получаем <code>char</code> и сравниваем его с <code>Y</code>, <code>y</code>, <code>N</code>, или <code>n</code>, чтобы определить, что было сказано: yes или no.</p>
</li>
<li>
<p>В Python мы просто пишем <code>or</code> или <code>and</code>, вместо <code>||</code> и <code>&amp;&amp;</code>.</p>
</li>
<li>
<p>В Си мы сравниваем <code>char</code>'ы, используя одинарные кавычки, но в Python один символ - тоже является string'ом. Хорошей новостью является то, что мы можем сравнивать строки (strings) обычным оператором <code>==</code>, и он будет сравнивать их так, как мы могли бы этого ожидать (возвращая  <code>True</code>, при равности обеих строк). Более того в Python, как одинарные кавычки <code>'</code>, так и двойные <code>"</code>, могут быть использованы для обозначения строк, главное чтобы и в начале, и в конце строки, они имели одинаковый вид.</p>
</li>
</ul>
</div>
</li>
<li>
<p>В Си мы также создавали программу, которая позволяла получать положительный integer:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="c"><span class="tok-cp">#include</span> <span class="tok-cpf">&lt;cs50.h&gt;</span><span class="tok-cp"></span>
<span class="tok-cp">#include</span> <span class="tok-cpf">&lt;stdio.h&gt;</span><span class="tok-cp"></span>

<span class="tok-kt">int</span> <span class="tok-nf">get_positive_int</span><span class="tok-p">();</span>

<span class="tok-kt">int</span> <span class="tok-nf">main</span><span class="tok-p">(</span><span class="tok-kt">void</span><span class="tok-p">)</span>
<span class="tok-p">{</span>
    <span class="tok-kt">int</span> <span class="tok-n">i</span> <span class="tok-o">=</span> <span class="tok-n">get_positive_int</span><span class="tok-p">();</span>
    <span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;%i - это положительный integer</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">,</span> <span class="tok-n">i</span><span class="tok-p">);</span>
<span class="tok-p">}</span>

<span class="tok-kt">int</span> <span class="tok-nf">get_positive_int</span><span class="tok-p">(</span><span class="tok-kt">void</span><span class="tok-p">)</span>
<span class="tok-p">{</span>
    <span class="tok-kt">int</span> <span class="tok-n">n</span><span class="tok-p">;</span>
    <span class="tok-k">do</span>
    <span class="tok-p">{</span>
        <span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;n это &quot;</span><span class="tok-p">);</span>
        <span class="tok-n">n</span> <span class="tok-o">=</span> <span class="tok-n">get_int</span><span class="tok-p">();</span>
    <span class="tok-p">}</span>
    <span class="tok-k">while</span> <span class="tok-p">(</span><span class="tok-n">n</span> <span class="tok-o">&lt;</span> <span class="tok-mi">1</span><span class="tok-p">);</span>
    <span class="tok-k">return</span> <span class="tok-n">n</span><span class="tok-p">;</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Нам нужно было сперва объявить функцию, затем переменную <code>n</code>, а потом и цикл <code>do while</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Теперь мы можем написать:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-kn">import</span> <span class="tok-nn">cs50</span>

<span class="tok-k">def</span> <span class="tok-nf">main</span><span class="tok-p">():</span>
    <span class="tok-n">i</span> <span class="tok-o">=</span> <span class="tok-n">get_positive_int</span><span class="tok-p">()</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;{} - это положительный integer&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">))</span>

<span class="tok-k">def</span> <span class="tok-nf">get_positive_int</span><span class="tok-p">():</span>
    <span class="tok-k">while</span> <span class="tok-bp">True</span><span class="tok-p">:</span>
        <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;n это &quot;</span><span class="tok-p">,</span> <span class="tok-n">end</span><span class="tok-o">=</span><span class="tok-s2">&quot;&quot;</span><span class="tok-p">)</span>
        <span class="tok-n">n</span> <span class="tok-o">=</span> <span class="tok-n">cs50</span><span class="tok-o">.</span><span class="tok-n">get_int</span><span class="tok-p">()</span>
        <span class="tok-k">if</span> <span class="tok-n">n</span> <span class="tok-o">&gt;</span> <span class="tok-mi">0</span><span class="tok-p">:</span>
            <span class="tok-k">break</span>
    <span class="tok-k">return</span> <span class="tok-n">n</span>

<span class="tok-k">if</span> <span class="tok-vm">__name__</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;__main__&quot;</span><span class="tok-p">:</span>
    <span class="tok-n">main</span><span class="tok-p">()</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Нам не нужно объявлять функцию <code>get_positive_int</code> до того как мы ее вызовем. Главное чтобы ее не пришлось запускать до того, как мы доберемся до участка с ее описанием. В данном случае, мы вызываем <code>get_positive_int</code> в нашей функции <code>main</code>, но сам <code>main</code> будет запущен только в самой последней строке нашего кода, поэтому все, что находится в нашей программе, будет при запуске объявлено и готово к работе.</p>
</li>
<li>
<p>И нам не нужно уточнять, что <code>get_positive_int</code> не принимает никаких аргументов, мы просто пишем <code>()</code> вместо <code>(void)</code>.</p>
</li>
<li>
<p>У Python также нет цикла <code>do while</code>, вместо него используется конструкция <code>while True</code>. И наш цикл завершает свою работу словом <code>break</code>, при условии <code>if n &gt; 0</code>.</p>
</li>
<li>
<p>Функция вернет переменную <code>n</code>, но обратите внимание на то, что нам не пришлось объявлять ее за пределами цикла, как мы это делали в Си, чтобы переменная была доступна в другой части кода. <code>n</code> будет создана в первом запуске нашего цикла и далее будет идти только изменение ее значения.</p>
</li>
<li>
<p>И наконец, нам нужно вызвать функцию <code>main</code> двумя последними линиями.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Мы могли бы повторно имплементировать программу <code>cough</code> (кашель), чтобы трижды произнести "кхе-кхе":</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;кхе-кхе&quot;</span><span class="tok-p">)</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;кхе-кхе&quot;</span><span class="tok-p">)</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;кхе-кхе&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
</li>
<li>
<p>С циклом:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-mi">3</span><span class="tok-p">):</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;кхе-кхе&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
</li>
<li>
<p>С помощью функции:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-k">def</span> <span class="tok-nf">main</span><span class="tok-p">():</span>
    <span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-mi">3</span><span class="tok-p">):</span>
        <span class="tok-n">cough</span><span class="tok-p">()</span>

<span class="tok-k">def</span> <span class="tok-nf">cough</span><span class="tok-p">():</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;кхе-кхе&quot;</span><span class="tok-p">)</span>

<span class="tok-k">if</span> <span class="tok-vm">__name__</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;__main__&quot;</span><span class="tok-p">:</span>
    <span class="tok-n">main</span><span class="tok-p">()</span></code></pre>
</div>
</div>
</li>
<li>
<p>Мы можем добавить аргумент нашей функции <code>cough</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-k">def</span> <span class="tok-nf">main</span><span class="tok-p">():</span>
    <span class="tok-n">cough</span><span class="tok-p">(</span><span class="tok-mi">3</span><span class="tok-p">)</span>

<span class="tok-k">def</span> <span class="tok-nf">cough</span><span class="tok-p">(</span><span class="tok-n">n</span><span class="tok-p">):</span>
    <span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-n">n</span><span class="tok-p">):</span>
        <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;кхе-кхе&quot;</span><span class="tok-p">)</span>

<span class="tok-k">if</span> <span class="tok-vm">__name__</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;__main__&quot;</span><span class="tok-p">:</span>
    <span class="tok-n">main</span><span class="tok-p">()</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Здесь <code>cough</code> принимает кое-какой аргумент <code>n</code>, чей тип будет автоматически установлен самим языком, в данном случае <code>int</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Мы можем дать функции сразу несколько аргументов:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-k">def</span> <span class="tok-nf">main</span><span class="tok-p">():</span>
    <span class="tok-n">cough</span><span class="tok-p">(</span><span class="tok-mi">3</span><span class="tok-p">)</span>
    <span class="tok-n">sneeze</span><span class="tok-p">(</span><span class="tok-mi">3</span><span class="tok-p">)</span>

<span class="tok-k">def</span> <span class="tok-nf">cough</span><span class="tok-p">(</span><span class="tok-n">n</span><span class="tok-p">):</span>
    <span class="tok-n">say</span><span class="tok-p">(</span><span class="tok-s2">&quot;кхе-кхе&quot;</span><span class="tok-p">,</span> <span class="tok-n">n</span><span class="tok-p">)</span>

<span class="tok-k">def</span> <span class="tok-nf">sneeze</span><span class="tok-p">(</span><span class="tok-n">n</span><span class="tok-p">):</span>
    <span class="tok-n">say</span><span class="tok-p">(</span><span class="tok-s2">&quot;апчхи&quot;</span><span class="tok-p">,</span> <span class="tok-n">n</span><span class="tok-p">)</span>

<span class="tok-k">def</span> <span class="tok-nf">say</span><span class="tok-p">(</span><span class="tok-n">word</span><span class="tok-p">,</span> <span class="tok-n">n</span><span class="tok-p">):</span>
    <span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-n">n</span><span class="tok-p">):</span>
        <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-n">word</span><span class="tok-p">)</span>

<span class="tok-k">if</span> <span class="tok-vm">__name__</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;__main__&quot;</span><span class="tok-p">:</span>
    <span class="tok-n">main</span><span class="tok-p">()</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Так как мы отображаем на экране только переменную <code>word</code>, которая передается нашей функции <code>say</code>, мы можем просто написать <code>print(word)</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="more-complex-programs"><a class="link" href="#more-complex-programs">Более сложные программы</a></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>На 2 неделе мы имплементировали свою собственную программу <code>strlen</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="c"><span class="tok-cp">#include</span> <span class="tok-cpf">&lt;cs50.h&gt;</span><span class="tok-cp"></span>
<span class="tok-cp">#include</span> <span class="tok-cpf">&lt;stdio.h&gt;</span><span class="tok-cp"></span>

<span class="tok-kt">int</span> <span class="tok-nf">main</span><span class="tok-p">(</span><span class="tok-kt">void</span><span class="tok-p">)</span>
<span class="tok-p">{</span>
    <span class="tok-n">string</span> <span class="tok-n">s</span> <span class="tok-o">=</span> <span class="tok-n">get_string</span><span class="tok-p">();</span>
    <span class="tok-kt">int</span> <span class="tok-n">n</span> <span class="tok-o">=</span> <span class="tok-mi">0</span><span class="tok-p">;</span>
    <span class="tok-k">while</span> <span class="tok-p">(</span><span class="tok-n">s</span><span class="tok-p">[</span><span class="tok-n">n</span><span class="tok-p">]</span> <span class="tok-o">!=</span> <span class="tok-sc">&#39;\0&#39;</span><span class="tok-p">)</span>
    <span class="tok-p">{</span>
        <span class="tok-n">n</span><span class="tok-o">++</span><span class="tok-p">;</span>
    <span class="tok-p">}</span>
    <span class="tok-n">printf</span><span class="tok-p">(</span><span class="tok-s">&quot;%i</span><span class="tok-se">\n</span><span class="tok-s">&quot;</span><span class="tok-p">,</span> <span class="tok-n">n</span><span class="tok-p">);</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
</li>
<li>
<p>В Python эти детали реализации будут часто утаиваться, поэтому нам нужно будет постоянно пользоваться документацией и больше полагаться на встроенные функции (заранее написанные для нас):</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-kn">import</span> <span class="tok-nn">cs50</span>

<span class="tok-n">s</span> <span class="tok-o">=</span> <span class="tok-n">cs50</span><span class="tok-o">.</span><span class="tok-n">get_string</span><span class="tok-p">()</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-nb">len</span><span class="tok-p">(</span><span class="tok-n">s</span><span class="tok-p">))</span></code></pre>
</div>
</div>
</li>
<li>
<p>Давайте попробуем преобразовать символы в ASCII:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-mi">65</span><span class="tok-p">,</span> <span class="tok-mi">65</span> <span class="tok-o">+</span> <span class="tok-mi">26</span><span class="tok-p">):</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;{} is {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-nb">chr</span><span class="tok-p">(</span><span class="tok-n">i</span><span class="tok-p">),</span> <span class="tok-n">i</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Мы можем уточнить начальное число и конечное в функции range (включая начальное число, но не конечное).</p>
</li>
<li>
<p>Потом, мы сперва выводим на экран <code>chr(i)</code>, а далее <code>i</code>, используя функцию Python <code>chr()</code>, которая превращает integer в <code>char</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Мы также можем пользоваться аргументами командной строки:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-kn">import</span> <span class="tok-nn">sys</span>

<span class="tok-k">if</span> <span class="tok-nb">len</span><span class="tok-p">(</span><span class="tok-n">sys</span><span class="tok-o">.</span><span class="tok-n">argv</span><span class="tok-p">)</span> <span class="tok-o">==</span> <span class="tok-mi">2</span><span class="tok-p">:</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;hello, {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">sys</span><span class="tok-o">.</span><span class="tok-n">argv</span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]))</span>
<span class="tok-k">else</span><span class="tok-p">:</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;hello, world&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Мы можем проверить количество аргументов, используя функцию <code>len(sys.argv)</code>, и получить доступ ко второму аргументу (вспомните, что первым аргументом будет имя программы) с помощью <code>sys.argv[1]</code>. Здесь <code>sys</code> является встроенным модулем Python, у которого есть аргументы командной строки.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Мы можем вывести все полученные нами аргументы:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-kn">import</span> <span class="tok-nn">sys</span>

<span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-nb">len</span><span class="tok-p">(</span><span class="tok-n">sys</span><span class="tok-o">.</span><span class="tok-n">argv</span><span class="tok-p">)):</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-n">sys</span><span class="tok-o">.</span><span class="tok-n">argv</span><span class="tok-p">[</span><span class="tok-n">i</span><span class="tok-p">])</span></code></pre>
</div>
</div>
</li>
<li>
<p>И мы можем вывести каждый символ каждого аргумента:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-kn">import</span> <span class="tok-nn">sys</span>

<span class="tok-k">for</span> <span class="tok-n">s</span> <span class="tok-ow">in</span> <span class="tok-n">sys</span><span class="tok-o">.</span><span class="tok-n">argv</span><span class="tok-p">:</span>
    <span class="tok-k">for</span> <span class="tok-n">c</span> <span class="tok-ow">in</span> <span class="tok-n">s</span><span class="tok-p">:</span>
        <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-n">c</span><span class="tok-p">)</span>
    <span class="tok-k">print</span><span class="tok-p">()</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>В конструкции <code>for s in sys.argv</code> мы получаем доступ к элементу <code>sys.argv</code> и называем его <code>s</code>. Типом каждого элемента будет string.</p>
</li>
<li>
<p>Потом, с помощью <code>for c in s</code>, мы получаем доступ к каждому элементу строки <code>s</code>, который мы будем называть <code>c</code>, так как каждый элемент является символом.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Мы также можем завершить программу, выходя из нее (<code>exit</code>) с каким-то значением (числом). Как это было с <code>возвращаемым</code> выходным кодом в Си:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-kn">import</span> <span class="tok-nn">cs50</span>
<span class="tok-kn">import</span> <span class="tok-nn">sys</span>

<span class="tok-k">if</span> <span class="tok-nb">len</span><span class="tok-p">(</span><span class="tok-n">sys</span><span class="tok-o">.</span><span class="tok-n">argv</span><span class="tok-p">)</span> <span class="tok-o">!=</span> <span class="tok-mi">2</span><span class="tok-p">:</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;введите аргумент командной строки&quot;</span><span class="tok-p">)</span>
    <span class="tok-nb">exit</span><span class="tok-p">(</span><span class="tok-mi">1</span><span class="tok-p">)</span>

<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;hello, {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">sys</span><span class="tok-o">.</span><span class="tok-n">argv</span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]))</span>
<span class="tok-nb">exit</span><span class="tok-p">(</span><span class="tok-mi">0</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>В Python для выхода из программы мы отдельно вызываем функцию <code>exit</code> вместе с кое-каким значением, так как у нас не всегда может присутствовать функция <code>main</code>, из которой мы могли бы что-то <code>возвращать</code>.</p>
</li>
<li>
<p>Также вспомните, что в командной строке мы можем написать <code>echo $?</code>, чтобы увидеть возвращаемое значение последней запущенной программы.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Мы можем сравнить две строки:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-kn">import</span> <span class="tok-nn">cs50</span>
<span class="tok-kn">import</span> <span class="tok-nn">sys</span>

<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;s: &quot;</span><span class="tok-p">,</span> <span class="tok-n">end</span><span class="tok-o">=</span><span class="tok-s2">&quot;&quot;</span><span class="tok-p">)</span>
<span class="tok-n">s</span> <span class="tok-o">=</span> <span class="tok-n">cs50</span><span class="tok-o">.</span><span class="tok-n">get_string</span><span class="tok-p">()</span>

<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;t: &quot;</span><span class="tok-p">,</span> <span class="tok-n">end</span><span class="tok-o">=</span><span class="tok-s2">&quot;&quot;</span><span class="tok-p">)</span>
<span class="tok-n">t</span> <span class="tok-o">=</span> <span class="tok-n">cs50</span><span class="tok-o">.</span><span class="tok-n">get_string</span><span class="tok-p">()</span>

<span class="tok-k">if</span> <span class="tok-n">s</span> <span class="tok-o">!=</span> <span class="tok-bp">None</span> <span class="tok-ow">and</span> <span class="tok-n">t</span> <span class="tok-o">!=</span> <span class="tok-bp">None</span><span class="tok-p">:</span>
    <span class="tok-k">if</span> <span class="tok-n">s</span> <span class="tok-o">==</span> <span class="tok-n">t</span><span class="tok-p">:</span>
        <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;одинаковые&quot;</span><span class="tok-p">)</span>
    <span class="tok-k">else</span><span class="tok-p">:</span>
        <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;разные&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Так как нам не придется больше работать с указателями (как это было в Си), вместо <code>null</code> мы воспользуемся особым значением <code>None</code> (возвращаемое функцией <code>get_string</code>), указывающее на то, что ничего не было возвращено.</p>
</li>
<li>
<p>В Си <code>s</code> и <code>t</code> являются двумя разными адресами, а в Python сравнение содержимого <code>s</code> и <code>t</code> будет автоматическим.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Копирование строки:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-kn">import</span> <span class="tok-nn">cs50</span>
<span class="tok-kn">import</span> <span class="tok-nn">sys</span>

<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;s: &quot;</span><span class="tok-p">,</span> <span class="tok-n">end</span><span class="tok-o">=</span><span class="tok-s2">&quot;&quot;</span><span class="tok-p">)</span>
<span class="tok-n">s</span> <span class="tok-o">=</span> <span class="tok-n">cs50</span><span class="tok-o">.</span><span class="tok-n">get_string</span><span class="tok-p">()</span>

<span class="tok-k">if</span> <span class="tok-n">s</span> <span class="tok-o">==</span> <span class="tok-bp">None</span><span class="tok-p">:</span>
    <span class="tok-nb">exit</span><span class="tok-p">(</span><span class="tok-mi">1</span><span class="tok-p">)</span>

<span class="tok-n">t</span> <span class="tok-o">=</span> <span class="tok-n">s</span><span class="tok-o">.</span><span class="tok-n">capitalize</span><span class="tok-p">()</span>

<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;s: {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">s</span><span class="tok-p">))</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;t: {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">t</span><span class="tok-p">))</span>

<span class="tok-nb">exit</span><span class="tok-p">(</span><span class="tok-mi">0</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Теперь мы можем запустить программу и увидеть, что в <code>t</code> хранится текст переменной <code>s</code>, но в <code>t</code> первая буква будет заглавной, в то время как содержимое <code>s</code> останется нетронутым.</p>
</li>
<li>
<p>Вспомните, что <code>s</code> - это объект Python'а, поэтому у него есть встроенные функции, которые мы можем вызвать из этого объекта, с помощью синтаксиса <code>.</code>. Мы можем воспользоваться функцией (а точнее методом) <code>s.capitalize()</code>, которая автоматически превращает первую букву в заглавную.</p>
</li>
<li>
<p>Более того, строки в Python являются неизменными (immutable), т.е. их нельзя изменить после их создания. Поэтому <code>s.capitalize()</code> возвращает копию переменной <code>s</code> (с первой заглавной буквой), которую далее нам нужно где-то сохранить (хотя, технически, мы могли бы сохранить результат внутри того же <code>s</code> с <code>s = s.capitalize()</code>, но тогда это была бы "новая" строка).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Мы можем поменять местами переменные, без разименования указателей. Попробуем передать эти переменные:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-k">def</span> <span class="tok-nf">main</span><span class="tok-p">():</span>
    <span class="tok-n">x</span> <span class="tok-o">=</span> <span class="tok-mi">1</span>
    <span class="tok-n">y</span> <span class="tok-o">=</span> <span class="tok-mi">2</span>

    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;x is {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">x</span><span class="tok-p">))</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;y is {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">y</span><span class="tok-p">))</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;Swapping...&quot;</span><span class="tok-p">)</span>
    <span class="tok-n">swap</span><span class="tok-p">(</span><span class="tok-n">x</span><span class="tok-p">,</span> <span class="tok-n">y</span><span class="tok-p">)</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;Swapped.&quot;</span><span class="tok-p">)</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;x is {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">x</span><span class="tok-p">))</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;y is {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">y</span><span class="tok-p">))</span>

<span class="tok-k">def</span> <span class="tok-nf">swap</span><span class="tok-p">(</span><span class="tok-n">a</span><span class="tok-p">,</span> <span class="tok-n">b</span><span class="tok-p">):</span>
    <span class="tok-n">tmp</span> <span class="tok-o">=</span> <span class="tok-n">a</span>
    <span class="tok-n">a</span> <span class="tok-o">=</span> <span class="tok-n">b</span>
    <span class="tok-n">b</span> <span class="tok-o">=</span> <span class="tok-n">tmp</span>

<span class="tok-k">if</span> <span class="tok-vm">__name__</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;__main__&quot;</span><span class="tok-p">:</span>
    <span class="tok-n">main</span><span class="tok-p">()</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Значения переменных не меняются местами, так как они опять, как и ранее, передаются копиями.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Но мы никак не можем задействовать указатели в Python'е, поэтому только следующим образом можно поменять местами значения:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-n">x</span> <span class="tok-o">=</span> <span class="tok-mi">1</span>
<span class="tok-n">y</span> <span class="tok-o">=</span> <span class="tok-mi">2</span>

<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;x это {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">x</span><span class="tok-p">))</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;y это {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">y</span><span class="tok-p">))</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;Swapping...&quot;</span><span class="tok-p">)</span>
<span class="tok-n">x</span><span class="tok-p">,</span> <span class="tok-n">y</span> <span class="tok-o">=</span> <span class="tok-n">y</span><span class="tok-p">,</span> <span class="tok-n">x</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;Swapped.&quot;</span><span class="tok-p">)</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;x это {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">x</span><span class="tok-p">))</span>
<span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;y это {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">y</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>В Python мы можем поменять местами значения переменных всего одной линией. Левая и правая сторона: <code>x, y</code> и <code>y, x</code> являются кортежами (tuples) - структурами данных, состоящие из нескольких значений. Мы устанавливаем элементы внутри <code>x, y</code> на внутренние элементы <code>y, x</code>, что, в свою очередь, меняет местами значения.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Также функция может возвращать несколько значений, поэтому нам возможно придется сохранять их как-то так <code>a, b, c, d = foo()</code></p>
</li>
<li>
<p>Давайте создадим структуры на Python:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-kn">import</span> <span class="tok-nn">cs50</span>
<span class="tok-kn">from</span> <span class="tok-nn">student</span> <span class="tok-kn">import</span> <span class="tok-n">Student</span>

<span class="tok-n">students</span> <span class="tok-o">=</span> <span class="tok-p">[]</span>
<span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-mi">3</span><span class="tok-p">):</span>

    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;name: &quot;</span><span class="tok-p">,</span> <span class="tok-n">end</span><span class="tok-o">=</span><span class="tok-s2">&quot;&quot;</span><span class="tok-p">)</span>
    <span class="tok-n">name</span> <span class="tok-o">=</span> <span class="tok-n">cs50</span><span class="tok-o">.</span><span class="tok-n">get_string</span><span class="tok-p">()</span>

    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;dorm: &quot;</span><span class="tok-p">,</span> <span class="tok-n">end</span><span class="tok-o">=</span><span class="tok-s2">&quot;&quot;</span><span class="tok-p">)</span>
    <span class="tok-n">dorm</span> <span class="tok-o">=</span> <span class="tok-n">cs50</span><span class="tok-o">.</span><span class="tok-n">get_string</span><span class="tok-p">()</span>

    <span class="tok-n">students</span><span class="tok-o">.</span><span class="tok-n">append</span><span class="tok-p">(</span><span class="tok-n">Student</span><span class="tok-p">(</span><span class="tok-n">name</span><span class="tok-p">,</span> <span class="tok-n">dorm</span><span class="tok-p">))</span>

<span class="tok-k">for</span> <span class="tok-n">student</span> <span class="tok-ow">in</span> <span class="tok-n">students</span><span class="tok-p">:</span>
    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;{} is in {}.&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">student</span><span class="tok-o">.</span><span class="tok-n">name</span><span class="tok-p">,</span> <span class="tok-n">student</span><span class="tok-o">.</span><span class="tok-n">dorm</span><span class="tok-p">))</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Сперва мы объявляем файл <code>student</code>, который мы позже создадим. Далее импортируем из него класс <code>Student</code>.</p>
</li>
<li>
<p>Потом мы можем создать пустой список под названием <code>students</code>, в котором будут хранится студенты. У нас есть возможность добавлять и удалять его элементы.</p>
</li>
<li>
<p>Потом мы получаем значения <code>name</code> (имени) и <code>dorm</code> (общежития). Создаем объект <code>Student</code>, передавая эти строки (strings, а точнее name и dorm) в качестве аргументов. Весь этот результат добавляем к концу списка <code>students</code>, через метод <code>append</code> (у списков тоже есть свои встроенные функции, в данном случае мы рассмотрели одну из них - <code>append</code>).</p>
</li>
<li>
<p>Наконец, мы выводим свойства каждого <code>student</code>'а, с помощью синтаксиса <code>.</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Чтобы создать модуль <code>student</code>, нам нужно сделать следующее:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-k">class</span> <span class="tok-nc">Student</span><span class="tok-p">:</span>
    <span class="tok-k">def</span> <span class="tok-fm">__init__</span><span class="tok-p">(</span><span class="tok-bp">self</span><span class="tok-p">,</span> <span class="tok-n">name</span><span class="tok-p">,</span> <span class="tok-n">dorm</span><span class="tok-p">):</span>
        <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">name</span> <span class="tok-o">=</span> <span class="tok-n">name</span>
        <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">dorm</span> <span class="tok-o">=</span> <span class="tok-n">dorm</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Мы объявляем <code>class</code> (класс) объектов под названием <code>Student</code>, у которого будет только один метод или встроенная функция <code><em>init</em></code>, которую мы не будем вызывать напрямую, но она будет автоматически вызвана при создании объекта на основе класса <code>Student</code>, как это было выше в коде с <code>Student(name, dorm)</code>.</p>
</li>
<li>
<p>Эта функция получает сам объект в качестве аргумента и другие аргументы, передаваемые при создании объекта, в данном случае <code>name</code> и <code>dorm</code>. Затем мы сохраняем аргументы в только что созданный объект.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Есть еще одна удобная особенность языка:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-kn">import</span> <span class="tok-nn">cs50</span>
<span class="tok-kn">import</span> <span class="tok-nn">csv</span>
<span class="tok-kn">from</span> <span class="tok-nn">student</span> <span class="tok-kn">import</span> <span class="tok-n">Student</span>

<span class="tok-n">students</span> <span class="tok-o">=</span> <span class="tok-p">[]</span>
<span class="tok-k">for</span> <span class="tok-n">i</span> <span class="tok-ow">in</span> <span class="tok-nb">range</span><span class="tok-p">(</span><span class="tok-mi">3</span><span class="tok-p">):</span>

    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;name: &quot;</span><span class="tok-p">,</span> <span class="tok-n">end</span><span class="tok-o">=</span><span class="tok-s2">&quot;&quot;</span><span class="tok-p">)</span>
    <span class="tok-n">name</span> <span class="tok-o">=</span> <span class="tok-n">cs50</span><span class="tok-o">.</span><span class="tok-n">get_string</span><span class="tok-p">()</span>

    <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;dorm: &quot;</span><span class="tok-p">,</span> <span class="tok-n">end</span><span class="tok-o">=</span><span class="tok-s2">&quot;&quot;</span><span class="tok-p">)</span>
    <span class="tok-n">dorm</span> <span class="tok-o">=</span> <span class="tok-n">cs50</span><span class="tok-o">.</span><span class="tok-n">get_string</span><span class="tok-p">()</span>

    <span class="tok-n">students</span><span class="tok-o">.</span><span class="tok-n">append</span><span class="tok-p">(</span><span class="tok-n">Student</span><span class="tok-p">(</span><span class="tok-n">name</span><span class="tok-p">,</span> <span class="tok-n">dorm</span><span class="tok-p">))</span>

<span class="tok-nb">file</span> <span class="tok-o">=</span> <span class="tok-nb">open</span><span class="tok-p">(</span><span class="tok-s2">&quot;students.csv&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;w&quot;</span><span class="tok-p">)</span>
<span class="tok-n">writer</span> <span class="tok-o">=</span> <span class="tok-n">csv</span><span class="tok-o">.</span><span class="tok-n">writer</span><span class="tok-p">(</span><span class="tok-nb">file</span><span class="tok-p">)</span>
<span class="tok-k">for</span> <span class="tok-n">student</span> <span class="tok-ow">in</span> <span class="tok-n">students</span><span class="tok-p">:</span>
    <span class="tok-n">writer</span><span class="tok-o">.</span><span class="tok-n">writerow</span><span class="tok-p">((</span><span class="tok-n">student</span><span class="tok-o">.</span><span class="tok-n">name</span><span class="tok-p">,</span> <span class="tok-n">student</span><span class="tok-o">.</span><span class="tok-n">dorm</span><span class="tok-p">))</span>
<span class="tok-nb">file</span><span class="tok-o">.</span><span class="tok-n">close</span><span class="tok-p">()</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Теперь, вместо того чтобы выводить students (студентов) на экран, мы можем записать их в файл <code>students.csv</code>, открывая его, далее используя встроенный модуль <code>csv</code>, который позволяет создавать файлы с разделенными запятыми значениями.</p>
</li>
<li>
<p>В выражении <code>csv.writer(file)</code> происходит передача, в качестве аргумента, открытого нами ранее файла, дабы получить объект <code>writer</code> (записыватель), который будет принимать tuples (кортежи), записывая их в файл с помощью метода <code>writerow</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Если бы мы запустили данную программу без <code>import csv</code>, интерпретатор выполнил бы функцию input, собирая такие вводимые данные как: <code>name</code> и <code>dorm</code>, далее создавая <code>students</code>. Но как только интерпретатор дойдет до <code>csv</code> и заметит отсутствие его объявления, будет зафиксировано исключение (т.е. программа остановится по причине ошибки).</p>
</li>
<li>
<p>Мы можем повторно имплементировать, используя язык Python, все примеры 1 - 5 недель и даже всю программу <a href="{{ site.url }}/weeks/pset5/speller"><code>speller</code></a>.</p>
</li>
<li>
<p>Посмотрим на файл <code>dictionary.py</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-k">class</span> <span class="tok-nc">Dictionary</span><span class="tok-p">:</span>

    <span class="tok-k">def</span> <span class="tok-fm">__init__</span><span class="tok-p">(</span><span class="tok-bp">self</span><span class="tok-p">):</span>
        <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">words</span> <span class="tok-o">=</span> <span class="tok-nb">set</span><span class="tok-p">()</span>

    <span class="tok-k">def</span> <span class="tok-nf">check</span><span class="tok-p">(</span><span class="tok-bp">self</span><span class="tok-p">,</span> <span class="tok-n">word</span><span class="tok-p">):</span>
        <span class="tok-k">return</span> <span class="tok-n">word</span><span class="tok-o">.</span><span class="tok-n">lower</span><span class="tok-p">()</span> <span class="tok-ow">in</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">words</span>

    <span class="tok-k">def</span> <span class="tok-nf">load</span><span class="tok-p">(</span><span class="tok-bp">self</span><span class="tok-p">,</span> <span class="tok-n">dictionary</span><span class="tok-p">):</span>
        <span class="tok-nb">file</span> <span class="tok-o">=</span> <span class="tok-nb">open</span><span class="tok-p">(</span><span class="tok-n">dictionary</span><span class="tok-p">,</span> <span class="tok-s2">&quot;r&quot;</span><span class="tok-p">)</span>
        <span class="tok-k">for</span> <span class="tok-n">line</span> <span class="tok-ow">in</span> <span class="tok-nb">file</span><span class="tok-p">:</span>
            <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">words</span><span class="tok-o">.</span><span class="tok-n">add</span><span class="tok-p">(</span><span class="tok-n">line</span><span class="tok-o">.</span><span class="tok-n">rstrip</span><span class="tok-p">(</span><span class="tok-s2">&quot;</span><span class="tok-se">\n</span><span class="tok-s2">&quot;</span><span class="tok-p">))</span>
        <span class="tok-nb">file</span><span class="tok-o">.</span><span class="tok-n">close</span><span class="tok-p">()</span>
        <span class="tok-k">return</span> <span class="tok-bp">True</span>

    <span class="tok-k">def</span> <span class="tok-nf">size</span><span class="tok-p">(</span><span class="tok-bp">self</span><span class="tok-p">):</span>
        <span class="tok-k">return</span> <span class="tok-nb">len</span><span class="tok-p">(</span><span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">words</span><span class="tok-p">)</span>

    <span class="tok-k">def</span> <span class="tok-nf">unload</span><span class="tok-p">(</span><span class="tok-bp">self</span><span class="tok-p">):</span>
        <span class="tok-k">return</span> <span class="tok-bp">True</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Здесь, при каждой инициализации словаря, мы создаем свойство <code>words</code> и задаем ему пустой <code>set</code> (набор).
В Python, set'ы абстрагируются (поэтому мы не имеем представление о их имплементации в памяти или являются ли они хеш-таблицами ), несмотря на это мы можем с легкостью управлять ими.</p>
</li>
<li>
<p>Мы можем добавлять элементы в <code>self.words</code> с помощью <code>self.words.add()</code>. Проверять есть ли в нем слово (word), используя <code>word in self.words()</code>. И получать размер, при помощи <code>len(self.words)</code>.</p>
</li>
<li>
<p>И так как Python управляет всей этой памятью за нас, нам не придется задумываться над тем, как выгружать или освобождать ее.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Как мы могли наблюдать выше, такой высокоуровневый язык как Python, в котором имплементировано огромное количество низкоуровневого функционала (что могло бы занимать сотни строк в Си) позволяет нам писать более сложные программы, без необходимости ломать голову над всеми этими мелкими деталями имплементации.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="web-servers"><a class="link" href="#web-servers">Веб-сервер</a></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>На 6 неделе мы успели поговорить о том, как связываются сервера и браузеры. Мы всего лишь открывали файлы HTML, созданные нами в рабочей среде (workspaces), без обращения к серверу, который способен генерировать динамический ответ.</p>
</li>
<li>
<p>Нашей задачей будет имплементировать веб-сервер на Python'е. Он сможет принимать HTTP-запрос и предоставлять кое-какой ответ со сгенерированным HTML-контентом.</p>
</li>
<li>
<p>Но сперва нам нужно познакомиться с кое-какой моделью:</p>
<div class="imageblock">
<div class="content">
<img src="{{ site.url }}/assets/images/notes/notes8/1.jpg" alt="MVC" width="500"></div>
</div>
<div class="ulist">
<ul>
<li>
<p>Эта популярная схема или шаблон проектирования веб-приложения имеет название MVC или Model-View-Controller («Модель-Представление-Контроллер», «Модель-Вид-Контроллер») .</p>
</li>
<li>
<p>В "контроллере" (C) находится логика, которой мы определяем поведение кода, при получении опредленных запросов. Например определение залогинился ли пользоватедь или нет.</p>
</li>
<li>
<p>В "представлении" (V) находится внешний вид нашего сайта, с HTML шаблонами и CSS стилями.</p>
</li>
<li>
<p>В "модели" (M) находятся данные, которыми "контроллер" заполняет "представления".</p>
</li>
</ul>
</div>
</li>
<li>
<p>Мы будем акцентировать внимание на V и C.</p>
</li>
<li>
<p>Python поставляется со встроенными возможностями веб-сервера, запуская на вашем компьютере программу, способную слушать запросы исходящие из интернета к вашему компьютеру и отвечать на них. Мы создадим свой собственный класс <code>HTTPServer_RequestHandler</code>, который унаследует (заберет себе методы) от класса <code>BaseHTTPRequestHandler</code> (данный класс встроен в Python):</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-kn">from</span> <span class="tok-nn">http.server</span> <span class="tok-kn">import</span> <span class="tok-n">BaseHTTPRequestHandler</span><span class="tok-p">,</span> <span class="tok-n">HTTPServer</span>

<span class="tok-c1"># HTTPRequestHandler класс</span>
<span class="tok-k">class</span> <span class="tok-nc">HTTPServer_RequestHandler</span><span class="tok-p">(</span><span class="tok-n">BaseHTTPRequestHandler</span><span class="tok-p">):</span>

    <span class="tok-c1"># GET</span>
    <span class="tok-k">def</span> <span class="tok-nf">do_GET</span><span class="tok-p">(</span><span class="tok-bp">self</span><span class="tok-p">):</span>
        <span class="tok-c1"># отправить код состояния</span>
        <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">send_response</span><span class="tok-p">(</span><span class="tok-mi">200</span><span class="tok-p">)</span>

        <span class="tok-c1"># отправить заголовки</span>
        <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">send_header</span><span class="tok-p">(</span><span class="tok-s1">&#39;Content-type&#39;</span><span class="tok-p">,</span><span class="tok-s1">&#39;text/html&#39;</span><span class="tok-p">)</span>
        <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">end_headers</span><span class="tok-p">()</span>

        <span class="tok-c1"># определение отправляемого клиенту сообщения</span>
        <span class="tok-k">if</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">path</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;/&quot;</span><span class="tok-p">:</span>
            <span class="tok-n">message</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;Hello, world!&quot;</span>
        <span class="tok-k">else</span><span class="tok-p">:</span>
            <span class="tok-n">name</span> <span class="tok-o">=</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">path</span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">:]</span>
            <span class="tok-n">message</span> <span class="tok-o">=</span> <span class="tok-s2">&quot;Hello, {}!&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">name</span><span class="tok-p">)</span>

        <span class="tok-c1"># записать сообщение</span>
        <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">wfile</span><span class="tok-o">.</span><span class="tok-n">write</span><span class="tok-p">(</span><span class="tok-nb">bytes</span><span class="tok-p">(</span><span class="tok-n">message</span><span class="tok-p">,</span> <span class="tok-s2">&quot;utf8&quot;</span><span class="tok-p">))</span>
        <span class="tok-k">return</span>
<span class="tok-o">...</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Мы напишем для сервера свою собственную функцию <code>do_GET</code>, которая будет вызвана при получении <code>GET</code> запроса. Наш сервер всегда будет возвращать код <code>200</code>, заголовок и сообщение.</p>
</li>
<li>
<p>О всех этих особенностях и функциях Python мы узнаем с помощью онлайн документации.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Далее нам нужно запустить сервер:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-o">...</span>
<span class="tok-k">def</span> <span class="tok-nf">run</span><span class="tok-p">():</span>
  <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s1">&#39;запускаю сервер...&#39;</span><span class="tok-p">)</span>

  <span class="tok-c1"># настройка сервера</span>
  <span class="tok-n">port</span> <span class="tok-o">=</span> <span class="tok-mi">8080</span>
  <span class="tok-n">server_address</span> <span class="tok-o">=</span> <span class="tok-p">(</span><span class="tok-s1">&#39;127.0.0.1&#39;</span><span class="tok-p">,</span> <span class="tok-n">port</span><span class="tok-p">)</span>
  <span class="tok-n">httpd</span> <span class="tok-o">=</span> <span class="tok-n">HTTPServer</span><span class="tok-p">(</span><span class="tok-n">server_address</span><span class="tok-p">,</span> <span class="tok-n">HTTPServer_RequestHandler</span><span class="tok-p">)</span>

  <span class="tok-c1"># запуск сервера</span>
  <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s1">&#39;запускаю сервер на порте {}...&#39;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">port</span><span class="tok-p">))</span>
  <span class="tok-n">httpd</span><span class="tok-o">.</span><span class="tok-n">serve_forever</span><span class="tok-p">()</span>


<span class="tok-n">run</span><span class="tok-p">()</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Мы уточняем порт, с которого мы хотим получать сообщения. Адрес сервера <code>127.0.0.1</code> всегда будет указывать на наш компьютер. Создайте <code>HTTPServer</code>, который встроен в сам Python. Мы ему передаем свой собственный <code>HTTPServer_RequestHandler</code> (серверный обработчик запросов). И, наконец, мы запустим его (сервер), используя функцию <code>serve_forever</code> (вечно служить).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Программу запустили и похоже, что ничего не происходит. Но если мы откроем браузер и посетим <code><a href="http://127.0.0.1:8080" class="bare">http://127.0.0.1:8080</a></code> (в CS50 IDE адрес будет отличаться), то увидим:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>hello, world</code></pre>
</div>
</div>
</li>
<li>
<p>Но это просто текст и чтобы написать код, который генерировал бы полностью новую HTML-страницу, нам бы понадобилось больше времени и, возможно, пара чашек кофе.</p>
</li>
<li>
<p>Мы можем воспользоваться фреймворком - коллекцией кода, содержащий еще большее количество функциональностей, которыми мы можем воспользоваться для построения наших проектов.</p>
</li>
<li>
<p>Одним из таких фреймворков, облегчающих задачу программистам, является Flask. Приложение, построенное с помощью данного фреймворка, будет выглядеть как-то так:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span class="tok-kn">from</span> <span class="tok-nn">flask</span> <span class="tok-kn">import</span> <span class="tok-n">Flask</span><span class="tok-p">,</span> <span class="tok-n">redirect</span><span class="tok-p">,</span> <span class="tok-n">render_template</span><span class="tok-p">,</span> <span class="tok-n">request</span><span class="tok-p">,</span> <span class="tok-n">session</span><span class="tok-p">,</span> <span class="tok-n">url_for</span>

<span class="tok-n">app</span> <span class="tok-o">=</span> <span class="tok-n">Flask</span><span class="tok-p">(</span><span class="tok-vm">__name__</span><span class="tok-p">)</span>

<span class="tok-nd">@app.route</span><span class="tok-p">(</span><span class="tok-s2">&quot;/&quot;</span><span class="tok-p">)</span>
<span class="tok-k">def</span> <span class="tok-nf">index</span><span class="tok-p">():</span>
    <span class="tok-k">return</span> <span class="tok-n">render_template</span><span class="tok-p">(</span><span class="tok-s2">&quot;index.html&quot;</span><span class="tok-p">)</span>

<span class="tok-nd">@app.route</span><span class="tok-p">(</span><span class="tok-s2">&quot;/register&quot;</span><span class="tok-p">,</span> <span class="tok-n">methods</span><span class="tok-o">=</span><span class="tok-p">[</span><span class="tok-s2">&quot;POST&quot;</span><span class="tok-p">])</span>
<span class="tok-k">def</span> <span class="tok-nf">register</span><span class="tok-p">():</span>
    <span class="tok-k">if</span> <span class="tok-n">request</span><span class="tok-o">.</span><span class="tok-n">form</span><span class="tok-p">[</span><span class="tok-s2">&quot;name&quot;</span><span class="tok-p">]</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;&quot;</span> <span class="tok-ow">or</span> <span class="tok-s2">&quot;captain&quot;</span> <span class="tok-ow">not</span> <span class="tok-ow">in</span> <span class="tok-n">request</span><span class="tok-o">.</span><span class="tok-n">form</span> <span class="tok-ow">or</span> <span class="tok-s2">&quot;comfort&quot;</span> <span class="tok-ow">not</span> <span class="tok-ow">in</span> <span class="tok-n">request</span><span class="tok-o">.</span><span class="tok-n">form</span> <span class="tok-ow">or</span> <span class="tok-n">request</span><span class="tok-o">.</span><span class="tok-n">form</span><span class="tok-p">[</span><span class="tok-s2">&quot;dorm&quot;</span><span class="tok-p">]</span> <span class="tok-o">==</span> <span class="tok-s2">&quot;&quot;</span><span class="tok-p">:</span>
        <span class="tok-k">return</span> <span class="tok-n">render_template</span><span class="tok-p">(</span><span class="tok-s2">&quot;failure.html&quot;</span><span class="tok-p">)</span>
    <span class="tok-k">return</span> <span class="tok-n">render_template</span><span class="tok-p">(</span><span class="tok-s2">&quot;success.html&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Мы сперва <code>import</code> (добавляем) огромное количество функциональности <code>from flask</code> (из flask'a), и создаем <code>app</code> (приложение).</p>
</li>
<li>
<p>Далее у нас идет линия <code>@app.route("/")</code>, которая говорит, что следующая функция должна вызываться при запросе данного адреса у веб-сервера. В данном случае, функция вернет <code>render_template("index.html")</code> или просто то, что в себе несет файл <code>index.html</code>.</p>
</li>
<li>
<p>Потом, если мы увидим <code>@app.route("/register", methods=["POST"])</code>, т.е. то, как отправляется запрос <code>POST</code> нашему <code>/register</code>, мы вызовем нижеидущую функцию <code>register</code>. Данная функция, если у нас в <code>form</code>'е будут отсутствовать определенные элементы, вернет шаблон <code>failure.html</code>. В противном случае, она вернет <code>success.html</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Таким образом мы запустим это приложение, перейдя в папку с <code>application.py</code> файлом и выполнив <code>$ flask run --host=0.0.0.0 --port=8080</code>. Указывая <code>--host=0.0.0.0</code> мы уточняем, что приложение будет принимать запросы с любого адреса.</p>
</li>
<li>
<p>Теперь, если мы наберем в браузере <code><a href="http://127.0.0.1:8080" class="bare">http://127.0.0.1:8080</a></code>, то получим имплементированную нами форму (из файла) <code>index.html</code>:</p>
<div class="imageblock">
<div class="content">
<img src="{{ site.url }}/assets/images/notes/notes8/2.jpg" alt="form" width="200"></div>
</div>
</li>
<li>
<p>И если мы заполним данную форму, мы увидим сообщение либо с ошибкой, либо с поздравлением. Все зависит от заполненности формы:</p>
<div class="imageblock">
<div class="content">
<img src="{{ site.url }}/assets/images/notes/notes8/3.jpg" alt="failure" width="200"></div>
</div>
<div class="imageblock">
<div class="content">
<img src="{{ site.url }}/assets/images/notes/notes8/4.jpg" alt="success" width="200"></div>
</div>
<div class="ulist">
<ul>
<li>
<p>На самом деле, даже если мы полностью заполним форму, никакой регистрации не произойдет, так как у этого приложения не существует базы данных или места, где хранились бы введенные пользователем данные.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Но, как бы там не было, давайте взглянем на <code>failure.html</code> (неудача):</p>
<div class="listingblock">
<div class="content">
	{% raw %}
<pre class="pygments highlight"><code>{% extends "layout.html" %}

{% block title %}
Registration Failed
{% endblock %}

{% block body %}
You must provide your name, comfort, and dorm!
{% endblock %}</code></pre>
{% endraw %}
</div>
</div>
<div class="ulist">
<ul>
<li>
{% raw %}
<p>Здесь не так много логики, но, похоже, что мы дополняем файл под названием <code>layout.html</code>, в котором, скорее всего, находится всего лишь обычная структура страницы. Затем, с помощью <code>{% block title %}</code> и <code>{% block body %}</code>, мы указываем, что должно быть внутри title и внутри body.</p>
{% endraw %}
</li>
</ul>
</div>
</li>
<li>
<p>У <code>success.html</code> есть что-то подобное:</p>
<div class="listingblock">
<div class="content">
	{% raw %}
<pre class="pygments highlight"><code>{% extends "layout.html" %}

{% block title %}
Registration Successful
{% endblock %}

{% block body %}
You are registered!  (Well, not really.)
{% endblock %}</code></pre>
{% endraw %}
</div>
</div>
</li>
<li>
<p>И у <code>layout.html</code>:</p>
<div class="listingblock">
<div class="content">
	{% raw %}
<pre class="pygments highlight"><code>&lt;!DOCTYPE html&gt;

&lt;html&gt;
    &lt;head&gt;
        &lt;meta content="initial-scale=1, width=device-width" name="viewport"/&gt;
        &lt;title&gt;{% block title %}{% endblock %}&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        {% block body %}
        {% endblock %}
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
{% endraw %}
</div>
</div>
<div class="ulist">
<ul>
<li>
{% raw %}
<p>Мы видим в данном файле одни и те же магические слова <code>{% block title %}</code> и <code>{% block body %}</code>, которые работают не благодаря HTML или Python, а благодаря фреймворку Flask (функция <code>render_template</code>), строящий веб-страницы с помощью данных шаблонов.</p>
{% endraw %}
</li>
</ul>
</div>
</li>
<li>
<p>Форма в <code>index.html</code>:</p>
<div class="listingblock">
<div class="content">
{% raw %}
<pre class="pygments highlight"><code>{% extends "layout.html" %}

{% block title %}
Frosh IMs
{% endblock %}

{% block body %}
&lt;div style="text-align:center"&gt;
    &lt;h1&gt;Register for Frosh IMs&lt;/h1&gt;
    &lt;form action="{{ url_for('register') }}" method="post"&gt;
        Name: &lt;input name="name" type="text"/&gt;
        &lt;br/&gt;
        &lt;input name="captain" type="checkbox"/&gt; Captain?
        &lt;br/&gt;
        &lt;input name="comfort" type="radio" value="less"/&gt; Less Comfortable
        &lt;input name="comfort" type="radio" value="more"/&gt; More Comfortable
        &lt;br/&gt;
        Dorm:
        &lt;select name="dorm"&gt;
            &lt;option value=""&gt;&lt;/option&gt;
            &lt;option value="Apley Court"&gt;Apley Court&lt;/option&gt;
            &lt;option value="Canaday"&gt;Canaday&lt;/option&gt;
            &lt;option value="Grays"&gt;Grays&lt;/option&gt;
            &lt;option value="Greenough"&gt;Greenough&lt;/option&gt;
            &lt;option value="Hollis"&gt;Hollis&lt;/option&gt;
            &lt;option value="Holworthy"&gt;Holworthy&lt;/option&gt;
            &lt;option value="Hurlbut"&gt;Hurlbut&lt;/option&gt;
            &lt;option value="Lionel"&gt;Lionel&lt;/option&gt;
            &lt;option value="Matthews"&gt;Matthews&lt;/option&gt;
            &lt;option value="Mower"&gt;Mower&lt;/option&gt;
            &lt;option value="Pennypacker"&gt;Pennypacker&lt;/option&gt;
            &lt;option value="Stoughton"&gt;Stoughton&lt;/option&gt;
            &lt;option value="Straus"&gt;Straus&lt;/option&gt;
            &lt;option value="Thayer"&gt;Thayer&lt;/option&gt;
            &lt;option value="Weld"&gt;Weld&lt;/option&gt;
            &lt;option value="Wigglesworth"&gt;Wigglesworth&lt;/option&gt;
        &lt;/select&gt;
        &lt;br/&gt;
        &lt;input type="submit" value="Register"/&gt;
    &lt;/form&gt;
&lt;/div&gt;
{% endblock %}</code></pre>
{% endraw %}
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>{% raw %}
	Здесь в <code>{% block body %}</code> гораздо больше HTML кода. У формы также есть <code>{{ url_for('register') }}</code> для ее атрибута <code>action</code>, вызывающая функцию маршрутизации <code>register</code> (регистрирования) в нашем приложении, тем самым избегая хардкодинга.
	{% endraw %}
	</p>
</li>
</ul>
</div>
</li>
<li>
<p>Возвращаясь к нашему приложению, в часть где приводится маршрут <code>register</code> (регистриции),</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>@app.route("/register", methods=["POST"])
def register():
    if request.form["name"] == "" or "captain" not in request.form or "comfort" not in request.form or request.form["dorm"] == "":
        return render_template("failure.html")
    return render_template("success.html")</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>мы опять видим логику "контроллера", которая проверяет заполненность формы, а затем возвращает соответствующее "представление".</p>
</li>
</ul>
</div>
</li>
<li>
<p>Мы можем продемонстрировать еще одно простое приложение, которое позволяет нам выбирать сколь угодное количество <code>foo</code>, <code>bar</code> и <code>baz</code>:</p>
<div class="imageblock">
<div class="content">
<img src="{{ site.url }}/assets/images/notes/notes8/5.jpg" alt="store" width="200"></div>
</div>
</li>
<li>
<p>Приложение динамически генерирует страницу, которая даст нам знать сколько всего продуктов мы добавили в корзину:</p>
<div class="imageblock">
<div class="content">
<img src="{{ site.url }}/assets/images/notes/notes8/6.jpg" alt="cart" width="200"></div>
</div>
</li>
<li>
<p>И если мы закроем, а затем откроем окно браузера, мы увидим то же самое, добавленное нами, количество продуктов.</p>
</li>
<li>
<p>Простой код HTML формы, а также шаблона корзины:</p>
<div class="listingblock">
<div class="content">{% raw %}
<pre class="pygments highlight"><code>{% extends "layout.html" %}

{% block title %}
Cart
{% endblock %}

{% block body %}

&lt;h1&gt;Cart&lt;/h1&gt;

{% for item in cart %}
    {{ item["quantity"] }} : {{ item["name"] }}
    &lt;br/&gt;
{% endfor %}

{% endblock %}</code></pre>
{% endraw %}
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Обратите внимание, что мы можем вывести на экран каждый <code>item</code> (продукт) нашей переменной <code>cart</code> (корзины), используя цикл <code>for</code>. Мы имеем доступ к полям каждого объекта <code>item</code> (продукта), а именно к <code>quantity</code> (количеству) и к <code>name</code> (имени).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Дабы разобраться, что из себя представляет <code>cart</code> (корзина), нам нужно взглянуть в <code>application.py</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>from flask import Flask, redirect, render_template, request, session, url_for

app = Flask(__name__)
app.secret_key = "shhh"

@app.route("/", methods=["GET", "POST"])
def store():
    if request.method == "POST":
        for item in ["foo", "bar", "baz"]:
            if item not in session:
                session[item] = int(request.form[item])
            else:
                session[item] += int(request.form[item])
        return redirect(url_for("cart"))
    return render_template("store.html")

@app.route("/cart")
def cart():
    cart = []
    for item in ["foo", "bar", "baz"]:
        cart.append({"name":item.capitalize(), "quantity":session[item]})
    return render_template("cart.html", cart=cart)</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>shhh</code> - это всего лишь какое-то секретное значение, используемое нами для защиты нашей сессии (времени жизни определенного процесса) или корзины (конечно, дабы избежать случайного его угадывания злоумышленником, оно должно было быть намного длиннее и сложнее!)</p>
</li>
<li>
<p>В методе <code>store</code>, мы сперва проверяем будет ли запрос вида <code>POST</code>. Если это так, т.е. пользователь отправил форму, тогда мы добавим количество, указанное в форме для каждого <code>item</code> (продукта), в нашу <code>session</code> (сессию), если, конечно, продукт не будет являться уже занесенным в данный объект, в противном же случае мы увеличим его количество. И <code>session</code> представляет из себя объект, получаемый нами из фреймворка, который выступает в качестве продуктовой корзины, где мы можем сохранять информацию для каждого пользователя подключенного к нашему веб-серверу.</p>
</li>
<li>
<p>Метод <code>cart</code> (корзина) создает пустой список и хранит словарь каждого продукта, вместе с его названием и количеством, используя сессию для получения этого значения. Затем мы передаем результат (в качестве аргумента) функции <code>render_template</code>, чтобы сформировать страницу <code>cart.html</code>, которую мы видели выше.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Ого, мы многое успели разобрать! Однако, мы нащупали только поверхность того, на что способен язык программирования Python и многие другие, существующие на данный момент, фреймворки.</p>
</li>
</ul>
</div>
</div>
</div>
            </div>
        </div>
        
        
